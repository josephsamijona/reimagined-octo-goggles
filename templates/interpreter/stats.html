{% extends 'intbase.html' %}

{% block title %}Statistics - JH Bridge{% endblock %}

{% block content %}
    <!-- Summary Cards -->
    <div class="grid stats-grid">
        <div class="card stat-card">
            <div class="card-content">
                <i class="fas fa-dollar-sign mb-2"></i>
                <div class="stat-value">{{ total_earnings }}</div>
                <div class="stat-label">Total Earnings</div>
                <div class="stat-trend positive">
                    <i class="fas fa-arrow-up"></i>
                    <span>12% vs last month</span>
                </div>
            </div>
        </div>
        <div class="card stat-card">
            <div class="card-content">
                <i class="fas fa-clock mb-2"></i>
                <div class="stat-value">{{ total_hours }}</div>
                <div class="stat-label">Hours Interpreted</div>
                <div class="stat-trend positive">
                    <i class="fas fa-arrow-up"></i>
                    <span>8% vs last month</span>
                </div>
            </div>
        </div>
        <div class="card stat-card">
            <div class="card-content">
                <i class="fas fa-calendar-check mb-2"></i>
                <div class="stat-value">{{ completed_missions }}</div>
                <div class="stat-label">Completed Missions</div>
                <div class="stat-trend positive">
                    <i class="fas fa-arrow-up"></i>
                    <span>5% vs last month</span>
                </div>
            </div>
        </div>
    </div>

    <!-- Earnings Chart -->
    <div class="card mt-4">
        <div class="card-header">
            <h2 class="card-title">Monthly Earnings</h2>
            <div class="card-actions">
                <button class="btn btn-outline" onclick="updateEarningsChart('year')">Year</button>
                <button class="btn btn-outline active" onclick="updateEarningsChart('month')">Month</button>
                <button class="btn btn-outline" onclick="updateEarningsChart('week')">Week</button>
            </div>
        </div>
        <div class="card-content">
            <div id="earningsChart" style="height: 300px;"></div>
        </div>
    </div>

    <!-- Languages and Hours Distribution -->
    <div class="grid mt-4">
        <!-- Languages Pie Chart -->
        <div class="card">
            <div class="card-header">
                <h2 class="card-title">Languages Distribution</h2>
            </div>
            <div class="card-content">
                <div id="languagesChart" style="height: 300px;"></div>
            </div>
        </div>
        
        <!-- Hours by Day Chart -->
        <div class="card">
            <div class="card-header">
                <h2 class="card-title">Hours by Day</h2>
            </div>
            <div class="card-content">
                <div id="hoursChart" style="height: 300px;"></div>
            </div>
        </div>
    </div>

    <!-- Mission Status -->
    <div class="card mt-4">
        <div class="card-header">
            <h2 class="card-title">Mission Completion Rate</h2>
        </div>
        <div class="card-content">
            <div class="status-bars">
                <div class="status-item">
                    <div class="status-label">
                        <span>Completed</span>
                        <span>85%</span>
                    </div>
                    <div class="progress-bar">
                        <div class="progress" style="width: 85%; background: var(--success);"></div>
                    </div>
                </div>
                <div class="status-item">
                    <div class="status-label">
                        <span>Cancelled</span>
                        <span>10%</span>
                    </div>
                    <div class="progress-bar">
                        <div class="progress" style="width: 10%; background: var(--danger);"></div>
                    </div>
                </div>
                <div class="status-item">
                    <div class="status-label">
                        <span>No Show</span>
                        <span>5%</span>
                    </div>
                    <div class="progress-bar">
                        <div class="progress" style="width: 5%; background: var(--warning);"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>
{% endblock %}

{% block extra_css %}
<style>
    .stats-grid {
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: 1rem;
    }

    .stat-card {
        text-align: center;
        padding: 1.5rem;
    }

    .stat-trend {
        font-size: 0.9rem;
        margin-top: 0.5rem;
    }

    .stat-trend.positive {
        color: var(--success);
    }

    .stat-trend.negative {
        color: var(--danger);
    }

    .card-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 1rem;
        background: rgba(0, 0, 0, 0.2);
    }

    .card-title {
        font-size: 1.1rem;
        font-weight: 500;
        margin: 0;
    }

    .card-actions {
        display: flex;
        gap: 0.5rem;
    }

    .btn-outline {
        padding: 0.25rem 0.75rem;
        border: 1px solid rgba(255, 255, 255, 0.2);
        border-radius: 4px;
        background: transparent;
        color: var(--white);
        cursor: pointer;
        transition: all 0.3s;
    }

    .btn-outline:hover, .btn-outline.active {
        background: var(--primary-green);
        border-color: var(--primary-green);
    }

    .status-bars {
        display: flex;
        flex-direction: column;
        gap: 1rem;
    }

    .status-item {
        width: 100%;
    }

    .status-label {
        display: flex;
        justify-content: space-between;
        margin-bottom: 0.5rem;
        font-size: 0.9rem;
    }

    .progress-bar {
        height: 8px;
        background: rgba(255, 255, 255, 0.1);
        border-radius: 4px;
        overflow: hidden;
    }

    .progress {
        height: 100%;
        border-radius: 4px;
        transition: width 0.3s ease;
    }

    @media (max-width: 768px) {
        .card-actions {
            display: none;
        }
    }
</style>
{% endblock %}

{% block extra_scripts %}
<script src="https://cdnjs.cloudflare.com/ajax/libs/recharts/2.1.9/Recharts.js"></script>
<script>
    // Données d'exemple pour les graphiques
    const earningsData = [
        { month: 'Jan', amount: 2500 },
        { month: 'Feb', amount: 3200 },
        { month: 'Mar', amount: 2800 },
        { month: 'Apr', amount: 3500 },
        { month: 'May', amount: 4000 },
        { month: 'Jun', amount: 3800 }
    ];

    const languagesData = [
        { name: 'Spanish', value: 60 },
        { name: 'French', value: 25 },
        { name: 'Chinese', value: 15 }
    ];

    const hoursData = [
        { day: 'Mon', hours: 6 },
        { day: 'Tue', hours: 8 },
        { day: 'Wed', hours: 7 },
        { day: 'Thu', hours: 9 },
        { day: 'Fri', hours: 5 },
        { day: 'Sat', hours: 4 },
        { day: 'Sun', hours: 2 }
    ];

    // Fonction pour mettre à jour les graphiques
    function updateEarningsChart(period) {
        // Mettre à jour le graphique en fonction de la période
        console.log('Updating chart for period:', period);
    }

    // Initialisation des graphiques (à implémenter avec Recharts)
    document.addEventListener('DOMContentLoaded', function() {
        // Initialiser les graphiques ici
    });
</script>
{% endblock %}